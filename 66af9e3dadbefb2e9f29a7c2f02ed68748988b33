{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "f788bdfa_2c44dd0b",
        "filename": "/COMMIT_MSG",
        "patchSetId": 6
      },
      "lineNbr": 10,
      "author": {
        "id": 1003247
      },
      "writtenOn": "2024-08-07T21:22:16Z",
      "side": 1,
      "message": "what does \u0027itself\u0027 mean? is the important part here the fact the src mac is our own? or the src ip is our link local ip?\n\nbecause -for example- afaik packets with our own mac will be dropped on wifi...\n\n\nhow do you expect to use this functionality in practice?\nie. why do you care about this test...",
      "range": {
        "startLine": 9,
        "startChar": 0,
        "endLine": 10,
        "endChar": 41
      },
      "revId": "66af9e3dadbefb2e9f29a7c2f02ed68748988b33",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "3b42d262_dced10c6",
        "filename": "/COMMIT_MSG",
        "patchSetId": 6
      },
      "lineNbr": 10,
      "author": {
        "id": 2016993
      },
      "writtenOn": "2024-08-08T01:41:40Z",
      "side": 1,
      "message": "This is for Thread Border Router\u0027s use case. We want to ensure that the kernel will add addresses/routes on receiving an RA from itself. The network could be WiFi or Ethernet. Without the route, we cannot forward packets from Thread to WiFi/Ethernet.\n\nThe RA messages are sent by an ICMPv6 socket created like [this](https://cs.android.com/android/platform/superproject/main/+/main:packages/modules/Connectivity/thread/service/java/com/android/server/thread/InfraInterfaceController.java;l\u003d55;drc\u003d0348cbe874814b1c9b3dcf1ed74719076a8508fb). So I think it\u0027s using the src mac of WiFi/Ethernet.\n\n\u003e because -for example- afaik packets with our own mac will be dropped on wifi...\n\nIs it caused by APF, DTIM or something else?",
      "parentUuid": "f788bdfa_2c44dd0b",
      "range": {
        "startLine": 9,
        "startChar": 0,
        "endLine": 10,
        "endChar": 41
      },
      "revId": "66af9e3dadbefb2e9f29a7c2f02ed68748988b33",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "71584f02_8f9a949b",
        "filename": "/COMMIT_MSG",
        "patchSetId": 6
      },
      "lineNbr": 10,
      "author": {
        "id": 1003247
      },
      "writtenOn": "2024-08-08T01:47:41Z",
      "side": 1,
      "message": "It\u0027s caused by wifi std/implementation basically.\n\nclient-\u003ewifi_AP-\u003eswitch-\u003erouter\n\nIf a client sends a multicast packet to the AP, the AP will of course send it to the switch, but it will also send it back to the client.\n\nThis is because it has to send it to any *other* wifi clients, and that is done by wifi broadcasting the packet back to *all* clients (using a shared crypto key instead of the client specific key used for unicast traffic).\n\nAs a result of this client side drivers will normally drop any incoming packet where the src mac of the frame is their own.\n\nIndeed if they don\u0027t you get bugs reported, because you end up seeing your own multicast traffic (which can for example fail ipv6 dad) ;-)",
      "parentUuid": "3b42d262_dced10c6",
      "range": {
        "startLine": 9,
        "startChar": 0,
        "endLine": 10,
        "endChar": 41
      },
      "revId": "66af9e3dadbefb2e9f29a7c2f02ed68748988b33",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "43e74688_0bc1be64",
        "filename": "/COMMIT_MSG",
        "patchSetId": 6
      },
      "lineNbr": 10,
      "author": {
        "id": 1003247
      },
      "writtenOn": "2024-08-08T01:53:00Z",
      "side": 1,
      "message": "Hmm, I\u0027m not at all sure, but I think the current implementation of this test doesn\u0027t test the behaviour that the code you linked uses.\n\nhere we have:\n  def ReceiveEtherPacketOn(self, netid, packet):\n    posix.write(self.tuns[netid].fileno(), bytes(packet))\n    \nso presumably uses tun/tap fd, which is not at all comparable to the raw socket case you linked.",
      "parentUuid": "71584f02_8f9a949b",
      "range": {
        "startLine": 9,
        "startChar": 0,
        "endLine": 10,
        "endChar": 41
      },
      "revId": "66af9e3dadbefb2e9f29a7c2f02ed68748988b33",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ef5fea1e_08f65bc4",
        "filename": "/COMMIT_MSG",
        "patchSetId": 6
      },
      "lineNbr": 10,
      "author": {
        "id": 2016993
      },
      "writtenOn": "2024-08-08T02:00:15Z",
      "side": 1,
      "message": "My previous understanding was that the `IP_MULTICAST_LOOP` option (which is by default on) can always ensure the kernel to receive multicast packets sent by itself. Is this correct?\n\nIs this a misunderstanding or it could be affected by the driver\u0027s implementation?",
      "parentUuid": "43e74688_0bc1be64",
      "range": {
        "startLine": 9,
        "startChar": 0,
        "endLine": 10,
        "endChar": 41
      },
      "revId": "66af9e3dadbefb2e9f29a7c2f02ed68748988b33",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "afe51bc6_197f632e",
        "filename": "/COMMIT_MSG",
        "patchSetId": 6
      },
      "lineNbr": 10,
      "author": {
        "id": 1003247
      },
      "writtenOn": "2024-08-08T02:17:25Z",
      "side": 1,
      "message": "That\u0027s *probably* true - I can\u0027t imagine that being driver dependent.\nBut this test doesn\u0027t AFAICS use that - it replicates RA coming in from a tun/tap which is more-or-less equivalent to coming in via an ethernet device...",
      "parentUuid": "ef5fea1e_08f65bc4",
      "range": {
        "startLine": 9,
        "startChar": 0,
        "endLine": 10,
        "endChar": 41
      },
      "revId": "66af9e3dadbefb2e9f29a7c2f02ed68748988b33",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e6f2409a_a03bca0b",
        "filename": "/COMMIT_MSG",
        "patchSetId": 6
      },
      "lineNbr": 10,
      "author": {
        "id": 1003247
      },
      "writtenOn": "2024-08-08T02:20:13Z",
      "side": 1,
      "message": "IP_MULTICAST_LOOP\n(RAW and UDP) Enables or disables loopback of outgoing multicast datagrams. Default is enable. When it is enabled, multicast applications that have joined the outgoing multicast group can receive a copy of the multicast datagrams destined for that address/port pair. The loopback indicator is passed as an u_char. The value 0 is specified to disable loopback. The value 1 is specified to enable loopback.\n\n- technically I guess this doesn\u0027t tell you if this includes kernel usecases or not, but it presumably should, since that\u0027s presumably just another usecase...\n\nAlthough it\u0027s certainly not 100% certain/guaranteed as it probably depends whether stuff is using \u0027normal\u0027 sockets or more standard ingress path processing.\n\n(for example does this stuff loopback in such a way that tcpdump shows it as ingress?)",
      "parentUuid": "afe51bc6_197f632e",
      "range": {
        "startLine": 9,
        "startChar": 0,
        "endLine": 10,
        "endChar": 41
      },
      "revId": "66af9e3dadbefb2e9f29a7c2f02ed68748988b33",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "0c06621a_af9cb111",
        "filename": "/COMMIT_MSG",
        "patchSetId": 6
      },
      "lineNbr": 10,
      "author": {
        "id": 1000835
      },
      "writtenOn": "2024-08-13T02:23:41Z",
      "side": 1,
      "message": "As Maciej points out, this test should be rewritten to use the same socket calls as ot-daemon uses (which, IIUC, is just an ICMPv6 socket with the loopback option turned on). It should check that the behaviour is as expected (AIUI the expected behaviour is to accept only some parts of the RA, like the PIO, but not other parts, like the routing).",
      "parentUuid": "e6f2409a_a03bca0b",
      "range": {
        "startLine": 9,
        "startChar": 0,
        "endLine": 10,
        "endChar": 41
      },
      "revId": "66af9e3dadbefb2e9f29a7c2f02ed68748988b33",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ad465843_daf595b3",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 6
      },
      "lineNbr": 0,
      "author": {
        "id": 2016993
      },
      "writtenOn": "2024-01-12T08:15:11Z",
      "side": 1,
      "message": "@lorenzo@google.com Could you take another look? Thanks!",
      "revId": "66af9e3dadbefb2e9f29a7c2f02ed68748988b33",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "52184219_b191c09c",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 6
      },
      "lineNbr": 0,
      "author": {
        "id": 1693933
      },
      "writtenOn": "2024-04-08T07:13:23Z",
      "side": 1,
      "message": "@handaw@google.com plan of moving this CL forward?",
      "revId": "66af9e3dadbefb2e9f29a7c2f02ed68748988b33",
      "serverId": "85c56323-6fa9-3386-8a01-6480fb634889"
    }
  ]
}